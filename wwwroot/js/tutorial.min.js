((t,e)=>{"function"==typeof define&&define.amd?define([],e):t.tutorial=e()})("undefined"!=typeof self?self:this,()=>{let n=function(){return this}(),_=n.document,m="tutorial";function b(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function w(t){return parseInt(getComputedStyle(t).height)}function x(t){return parseInt(getComputedStyle(t).width)}function C(t){var e=t.getBoundingClientRect();return{t:e.top+_.body.scrollTop,l:e.left+_.body.scrollLeft,w:t.offsetWidth,h:t.offsetHeight}}function e(t,i){console.debug("tutorial.js : Scrolling to element %o",t),t.scrollIntoView({behavior:"instant",block:"center"});let l=window.scrollY,o=0;requestAnimationFrame(function t(){var e=n.scrollY;if(e===l){if(7<++o)return void setTimeout(()=>i(),100)}else o=0,l=e;requestAnimationFrame(t)})}function L(f,v,y,g,t){if(f>=v.length)y();else{let a=v[f],p=("function"==typeof a.onCreate&&a.onCreate.apply(g,[f,a,t]),_.querySelector(a.target));if(!p)throw`Target for the step '${f}' was not found.`;let c=a.html||"",d=a.position||"right",h=v.length,u=a.onNext||function(t,e,i){i()};e(p,()=>{console.debug("tutorial.js : Target has been scrolled into the view %o",p);t=p,e=g.container,i=a,t=C(t),(l=_.createElement("div")).className=m+"__pulse",l.setAttribute("data-tutorial-target",i.target),l.innerHTML="<div></div><div></div><div></div><div></div>",l.style.width=t.w+"px",l.style.height=t.h+"px",l.style.top=t.t+"px",l.style.left=t.l+"px",e.appendChild(l);let o=l;var t,e,i,l;let n,r=new Promise(t=>{n=((t,e,i,l,o,n,r,s)=>{console.debug("tutorial.js : Creating tip for the step %d",o);var a=C(t);let p=_.createElement("div");switch(p.className=m+"__tip",p.setAttribute("data-tutorial-target",s.target),p.setAttribute("data-tutorial-position",l),p.innerHTML=`<div class="${m}__tip-container">
                            ${i}
                            <div class="${m}__footer">
                                <span>${o+1} / ${n}</span>
                                <button class="${m}__navigator">
                                    ${o+1<n?"<svg viewBox='0 0 24 24'><path fill='currentColor' d='M8,5.14V19.14L19,12.14L8,5.14Z' /></svg>":"<svg viewBox='0 0 24 24'><path fill='currentColor' d='M18,18H6V6H18V18Z' /></svg>"}
                                </button>
                            </div>
                        </div>`,e.appendChild(p),p.querySelector(`.${m}__navigator`).addEventListener("click",r),l){case"top":p.style.top=a.t-w(p)+"px",p.style.left=a.l+a.w/2+"px",b(p,m+"__tip--top");break;case"right":p.style.top=a.t+a.h/2+"px",p.style.left=a.l+a.w+"px",b(p,m+"__tip--right");break;case"bottom":p.style.top=a.t+a.h+"px",p.style.left=a.l+a.w/2+"px",b(p,m+"__tip--bottom");break;case"left":p.style.top=a.t+a.h/2+"px",p.style.left=a.l-x(p)+"px",b(p,m+"__tip--left")}return setTimeout(()=>b(p,m+"__tip--visible"),100),p})(p,g.container,c,d,f,h,u.bind(g,f+1,v[f+1],t),a)}),s=L.bind(g,f+1,v,y,g);r.then(t=>{let e=function(){n.removeEventListener("transitionend",e),o.parentNode.removeChild(o),n.parentNode.removeChild(n),r=null,s(t)};var i,l;n.addEventListener("transitionend",e),i=n,l=m+"__tip--visible",i.classList?i.classList.remove(l):i.className=i.className.replace(new RegExp("(^|\\b)"+l.split(" ").join("|")+"(\\b|$)","gi")," ")})})}}function i(t,e){this.steps=t||[],this.options=e||{},this.scrollContainer="function"==typeof this.options.scrollContainer?this.options.scrollContainer():"string"==typeof this.options.scrollContainer?_.querySelector(this.options.scrollContainer):n,this.container=null,this.promise=null,this._onEscapeHandler=null,this._onPulseScrollHandler=null,this._onTipScrollHandler=null,(!Array.isArray(this.steps)||this.steps.length<=0)&&console.error("Tutorial() : Unable to create empty tutorial.")}i.prototype.start=function(){var t;return this.container=((t=_.createElement("div")).className=m,_.body.appendChild(t),t),this.promise=new Promise(t=>{this._onEscapeHandler=function(t,e){return 27!==(e.which||e.keyCode)||(t(),!1)}.bind(this,t),this._onPulseScrollHandler=function(){var t,e=_.querySelector(".tutorial__pulse[data-tutorial-target]");e&&(t=_.querySelector(e.getAttribute("data-tutorial-target")))&&(t=C(t),e.style.width=t.w+"px",e.style.height=t.h+"px",e.style.top=t.t+"px",e.style.left=t.l+"px")}.bind(this),this._onTipScrollHandler=function(){var t=_.querySelector(".tutorial__tip[data-tutorial-target]");if(t){var e=_.querySelector(t.getAttribute("data-tutorial-target"));if(e){var i=C(e);switch(t.getAttribute("data-tutorial-position")){case"top":t.style.top=i.t-w(t)+"px",t.style.left=i.l+i.w/2+"px";break;case"right":t.style.top=i.t+i.h/2+"px",t.style.left=i.l+i.w+"px";break;case"bottom":t.style.top=i.t+i.h+"px",t.style.left=i.l+i.w/2+"px";break;case"left":t.style.top=i.t+i.h/2+"px",t.style.left=i.l-x(t)+"px"}}}}.bind(this),_.addEventListener("keydown",this._onEscapeHandler),this.scrollContainer.addEventListener("scroll",this._onPulseScrollHandler),this.scrollContainer.addEventListener("scroll",this._onTipScrollHandler),L(0,this.steps,t,this)}),this.promise.then(()=>{_.removeEventListener("keydown",this._onEscapeHandler),this.scrollContainer.removeEventListener("scroll",this._onPulseScrollHandler),this.scrollContainer.removeEventListener("scroll",this._onTipScrollHandler),_.body.removeChild(this.container)}),this.promise};return(...t)=>new i(...t)});