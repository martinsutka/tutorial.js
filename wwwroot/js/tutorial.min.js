((t,e)=>{"function"==typeof define&&define.amd?define([],e):t.tutorial=e()})("undefined"!=typeof self?self:this,()=>{let r=function(){return this}(),g=r.document,y="tutorial";function b(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function x(t){return parseInt(getComputedStyle(t).height)}function m(t){return parseInt(getComputedStyle(t).width)}function w(t){var e=t.getBoundingClientRect();return{t:e.top+g.body.scrollTop,l:e.left+g.body.scrollLeft,w:t.offsetWidth,h:t.offsetHeight}}function e(t,i){console.debug("tutorial.js : Scrolling to element %o",t),t.scrollIntoView({behavior:"instant",block:"center"});let n=window.scrollY,o=0;requestAnimationFrame(function t(){var e=r.scrollY;if(e===n){if(7<++o)return void setTimeout(()=>i(),100)}else o=0,n=e;requestAnimationFrame(t)})}function C(h,v,f,_,t){if(h>=v.length)f();else{let s=v[h],a=("function"==typeof s.onCreate&&s.onCreate.apply(_,[h,s,t]),g.querySelector(s.target));if(!a)throw`Target for the step '${h}' was not found.`;let p=s.html||"",c=s.position||"right",d=v.length,u=s.onNext||function(t,e,i){i(t)};e(a,()=>{console.debug("tutorial.js : Target has been scrolled into the view %o",a);t=a,e=_.container,i=s,t=w(t),(n=g.createElement("div")).className=y+"__pulse",n.setAttribute("data-tutorial-target",i.target),n.innerHTML="<div></div><div></div><div></div><div></div>",n.style.width=t.w+"px",n.style.height=t.h+"px",n.style.top=t.t+"px",n.style.left=t.l+"px",e.appendChild(n);let o=n;var t,e,i,n;let r,l=new Promise(t=>{r=((t,e,i,n,o,r,l,s,a,p,c)=>{console.debug("tutorial.js : Creating tip for the step %d",o);var d=w(t);let u=g.createElement("div");switch(u.className=y+"__tip",u.setAttribute("data-tutorial-target",p.target),u.setAttribute("data-tutorial-position",n),u.innerHTML=`<div class="${y}__tip-container">
                            ${i}
                            <div class="${y}__footer">
                                <span>${o+1} / ${r}</span>
                                <button class="${y}__navigator ${y}__navigator--prev ${0===o?"tutorial__navigator--hidden":""}">
                                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="m18 17l-8-5l8-5zM6 7h3v10H6z"/></svg>
                                    <span>${"string"==typeof p.prevText?p.prevText:c.prevText||""}</span>
                                </button>
                                <button class="${y}__navigator ${y}__navigator--stop">
                                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 7h10v10H7z"/></svg>
                                    <span>${"string"==typeof p.stopText?p.stopText:c.stopText||""}</span>
                                </button>
                                <button class="${y}__navigator ${y}__navigator--next ${o===r-1?"tutorial__navigator--hidden":""}">
                                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="m6 17l8-5l-8-5zM18 7h-3v10h3z"/></svg>
                                    <span>${"string"==typeof p.nextText?p.nextText:c.nextText||""}</span>
                                </button>
                            </div>
                        </div>`,e.appendChild(u),u.querySelector(`.${y}__navigator--next`).addEventListener("click",l),u.querySelector(`.${y}__navigator--prev`).addEventListener("click",s),u.querySelector(`.${y}__navigator--stop`).addEventListener("click",a),n){case"top":u.style.top=d.t-x(u)+"px",u.style.left=d.l+d.w/2+"px",b(u,y+"__tip--top");break;case"right":u.style.top=d.t+d.h/2+"px",u.style.left=d.l+d.w+"px",b(u,y+"__tip--right");break;case"bottom":u.style.top=d.t+d.h+"px",u.style.left=d.l+d.w/2+"px",b(u,y+"__tip--bottom");break;case"left":u.style.top=d.t+d.h/2+"px",u.style.left=d.l-m(u)+"px",b(u,y+"__tip--left")}return setTimeout(()=>b(u,y+"__tip--visible"),100),u})(a,_.container,p,c,h,d,u.bind(_,h+1,v[h+1],t),u.bind(_,h-1,v[h-1],t),u.bind(_,d,v[d],t),s,_.options)});l.then(t=>{let e=function(){r.removeEventListener("transitionend",e),o.parentNode.removeChild(o),r.parentNode.removeChild(r),l=null,C.apply(_,["number"==typeof t?t:h+1,v,f,_])};var i,n;r.addEventListener("transitionend",e),i=r,n=y+"__tip--visible",i.classList?i.classList.remove(n):i.className=i.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")})})}}function i(t,e){this.steps=t||[],this.options=e||{},this.scrollContainer="function"==typeof this.options.scrollContainer?this.options.scrollContainer():"string"==typeof this.options.scrollContainer?g.querySelector(this.options.scrollContainer):r,this.container=null,this.promise=null,this._onEscapeHandler=null,this._onPulseScrollHandler=null,this._onTipScrollHandler=null,(!Array.isArray(this.steps)||this.steps.length<=0)&&console.error("Tutorial() : Unable to create empty tutorial.")}i.prototype.start=function(){var t;return this.container=((t=g.createElement("div")).className=y,g.body.appendChild(t),t),this.promise=new Promise(t=>{this._onEscapeHandler=function(t,e){return 27!==(e.which||e.keyCode)||(t(),!1)}.bind(this,t),this._onPulseScrollHandler=function(){var t,e=g.querySelector(".tutorial__pulse[data-tutorial-target]");e&&(t=g.querySelector(e.getAttribute("data-tutorial-target")))&&(t=w(t),e.style.width=t.w+"px",e.style.height=t.h+"px",e.style.top=t.t+"px",e.style.left=t.l+"px")}.bind(this),this._onTipScrollHandler=function(){var t=g.querySelector(".tutorial__tip[data-tutorial-target]");if(t){var e=g.querySelector(t.getAttribute("data-tutorial-target"));if(e){var i=w(e);switch(t.getAttribute("data-tutorial-position")){case"top":t.style.top=i.t-x(t)+"px",t.style.left=i.l+i.w/2+"px";break;case"right":t.style.top=i.t+i.h/2+"px",t.style.left=i.l+i.w+"px";break;case"bottom":t.style.top=i.t+i.h+"px",t.style.left=i.l+i.w/2+"px";break;case"left":t.style.top=i.t+i.h/2+"px",t.style.left=i.l-m(t)+"px"}}}}.bind(this),g.addEventListener("keydown",this._onEscapeHandler),this.scrollContainer.addEventListener("scroll",this._onPulseScrollHandler),this.scrollContainer.addEventListener("scroll",this._onTipScrollHandler),C(0,this.steps,t,this)}),this.promise.then(()=>{g.removeEventListener("keydown",this._onEscapeHandler),this.scrollContainer.removeEventListener("scroll",this._onPulseScrollHandler),this.scrollContainer.removeEventListener("scroll",this._onTipScrollHandler),g.body.removeChild(this.container)}),this.promise};return(...t)=>new i(...t)});